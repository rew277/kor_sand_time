<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ - ìƒŒë””ì—ê³  ì‹œê°„ ë³€í™˜ê¸°</title>
    <style>
        body {
            font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            background-color: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 450px;
            text-align: center;
        }
        h2 {
            margin-bottom: 1.5rem;
            color: #333;
        }
        .time-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #555;
        }
        input[type="datetime-local"] {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-family: inherit;
        }
        input[type="datetime-local"]:focus {
            border-color: #007bff;
            outline: none;
        }
        .divider {
            margin: 1rem 0;
            color: #888;
            font-size: 1.2rem;
        }
        .info {
            font-size: 0.85rem;
            color: #666;
            margin-top: 0.5rem;
            background: #f8f9fa;
            padding: 8px;
            border-radius: 6px;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.3s;
            margin-bottom: 20px;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸŒ ì‹œê°„ ë³€í™˜ê¸°</h2>
    <button onclick="setNow()">í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ì´ˆê¸°í™”</button>

    <div class="time-group">
        <label for="koreaTime">ğŸ‡°ğŸ‡· í•œêµ­ (KST)</label>
        <input type="datetime-local" id="koreaTime" oninput="convertFromKorea()">
        <div class="info">UTC+9 (í‘œì¤€ì‹œ)</div>
    </div>

    <div class="divider">â‡… ìë™ ë³€í™˜ â‡…</div>

    <div class="time-group">
        <label for="sdTime">ğŸ‡ºğŸ‡¸ ìƒŒë””ì—ê³  (PST/PDT)</label>
        <input type="datetime-local" id="sdTime" oninput="convertFromSD()">
        <div class="info" id="sdInfo">UTC-8 (í˜¹ì€ ì¸ë¨¸íƒ€ì„ -7)</div>
    </div>
</div>

<script>
    const koreaInput = document.getElementById('koreaTime');
    const sdInput = document.getElementById('sdTime');
    const sdInfo = document.getElementById('sdInfo');

    // 1. í•œêµ­ ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ìƒŒë””ì—ê³  ì‹œê°„ ê³„ì‚°
    function convertFromKorea() {
        if (!koreaInput.value) return;

        // ì…ë ¥ëœ í•œêµ­ ì‹œê°„ì„ Date ê°ì²´ë¡œ ë³€í™˜ (ISO í¬ë§·ì— KST ì˜¤í”„ì…‹ +09:00 ì¶”ê°€)
        const dateStr = koreaInput.value; 
        const kstDate = new Date(dateStr + ":00+09:00");

        // ìƒŒë””ì—ê³  ì‹œê°„ëŒ€ë¡œ í¬ë§·íŒ…
        const sdString = formatToLocalISO(kstDate, 'America/Los_Angeles');
        sdInput.value = sdString;
        
        updateSDLabel(kstDate);
    }

    // 2. ìƒŒë””ì—ê³  ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ í•œêµ­ ì‹œê°„ ê³„ì‚°
    function convertFromSD() {
        if (!sdInput.value) return;

        const dateStr = sdInput.value; // ì˜ˆ: 2025-06-01T12:00
        
        // ìƒŒë””ì—ê³ ëŠ” ì¸ë¨¸íƒ€ì„ ë•Œë¬¸ì— ì˜¤í”„ì…‹ì´ ë³€í•˜ë¯€ë¡œ ë‹¨ìˆœ ê³„ì‚°ì´ ì–´ë µìŠµë‹ˆë‹¤.
        // ë”°ë¼ì„œ, ì…ë ¥ëœ ì‹œê°„ì„ í•´ë‹¹ ì§€ì—­(LA) ì‹œê°„ìœ¼ë¡œ í•´ì„í•˜ì—¬ Date ê°ì²´ë¥¼ ë§Œë“­ë‹ˆë‹¤.
        const sdDate = createDateFromZone(dateStr, 'America/Los_Angeles');

        // í•œêµ­ ì‹œê°„ëŒ€ë¡œ í¬ë§·íŒ…
        const kstString = formatToLocalISO(sdDate, 'Asia/Seoul');
        koreaInput.value = kstString;

        updateSDLabel(sdDate);
    }

    // íŠ¹ì • íƒ€ì„ì¡´ì˜ ë¬¸ìì—´ ì…ë ¥ì„ ì‹¤ì œ UTC ì ˆëŒ€ ì‹œê°„(Date ê°ì²´)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
    function createDateFromZone(localDateStr, timeZone) {
        // 1. ì¼ë‹¨ ì…ë ¥ê°’ì„ UTCë¡œ ê°€ì •í•˜ê³  Date ê°ì²´ ìƒì„±
        const tempDate = new Date(localDateStr + "Z");
        
        // 2. í•´ë‹¹ ì‹œê°„ì¼ ë•Œ íƒ€ì„ì¡´ì˜ ì‹¤ì œ ì‹œê°„ ë¬¸ìì—´ ì¶”ì¶œ
        // (ì˜ˆ: ì…ë ¥ì€ 12:00ì¸ë°, ì‹¤ì œ ê·¸ íƒ€ì„ì¡´ì€ 05:00ì¼ ìˆ˜ ìˆìŒ)
        const options = { 
            timeZone: timeZone, 
            year: 'numeric', month: '2-digit', day: '2-digit', 
            hour: '2-digit', minute: '2-digit', second: '2-digit', 
            hour12: false 
        };
        
        // í¬ë§·í„° ìƒì„±
        const fmt = new Intl.DateTimeFormat('en-US', options);
        
        // ì´ë¶„íƒìƒ‰ í˜¹ì€ ì˜¤í”„ì…‹ ê³„ì‚°ì„ í†µí•´ ì •í™•í•œ UTC ì‹œê°„ì„ ì°¾ìŠµë‹ˆë‹¤.
        // ë” ê°„ë‹¨í•œ ë°©ë²•: ì˜¤í”„ì…‹ ì—­ê³„ì‚° ë°©ì‹
        
        // ì…ë ¥ë°›ì€ ì‹œê°„ì„ íƒ€ê²Ÿ ì‹œê°„ìœ¼ë¡œ ê°„ì£¼
        const targetParts = tempDate.toISOString().slice(0, 19).replace('T', ' '); // ë‹¨ìˆœ ìˆ«ì ë¹„êµìš©
        
        // ì˜¤ì°¨ ë³´ì • ë£¨í”„ (ì•½ 2~3íšŒ ë°˜ë³µì´ë©´ ì •í™•í•´ì§)
        let bestGuess = new Date(tempDate.getTime());
        
        for(let i=0; i<3; i++) {
            const parts = fmt.formatToParts(bestGuess);
            const partObj = {};
            parts.forEach(p => partObj[p.type] = p.value);
            
            // íƒ€ì„ì¡´ì´ ì ìš©ëœ í˜„ì¬ ì¶”ì¸¡ ì‹œê°„ì˜ ë¬¸ìì—´ ì¬ì¡°ë¦½
            const guessLocalStr = `${partObj.year}-${partObj.month}-${partObj.day}T${partObj.hour}:${partObj.minute}`;
            const guessLocalTime = new Date(guessLocalStr + "Z").getTime();
            const inputLocalTime = new Date(localDateStr + "Z").getTime();
            
            const diff = inputLocalTime - guessLocalTime;
            
            if (diff === 0) break;
            bestGuess = new Date(bestGuess.getTime() + diff);
        }
        
        return bestGuess;
    }

    // Date ê°ì²´ë¥¼ 'YYYY-MM-DDTHH:mm' í˜•ì‹ì˜ ë¬¸ìì—´(input valueìš©)ë¡œ ë³€í™˜
    function formatToLocalISO(date, timeZone) {
        // ìŠ¤ì›¨ë´ ë¡œì¼€ì¼(sv-SE)ì´ ISO í¬ë§·(YYYY-MM-DD hh:mm:ss)ê³¼ ê°€ì¥ ìœ ì‚¬í•¨ì„ ì´ìš©í•œ íŠ¸ë¦­
        const options = {
            timeZone: timeZone,
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            hour12: false
        };
        
        const formatter = new Intl.DateTimeFormat('sv-SE', options);
        const parts = formatter.formatToParts(date);
        
        // ë¶€í’ˆ ì¡°ë¦½ (ë¸Œë¼ìš°ì € í˜¸í™˜ì„±ì„ ìœ„í•´ ìˆ˜ë™ ì¡°ë¦½)
        const getPart = (type) => parts.find(p => p.type === type).value;
        return `${getPart('year')}-${getPart('month')}-${getPart('day')}T${getPart('hour')}:${getPart('minute')}`;
    }

    // ìƒŒë””ì—ê³ ê°€ í˜„ì¬ ì¸ë¨¸íƒ€ì„(PDT)ì¸ì§€ í‘œì¤€ì‹œ(PST)ì¸ì§€ í‘œì‹œ
    function updateSDLabel(dateObj) {
        // í•´ë‹¹ ë‚ ì§œì˜ LA ì‹œê°„ ë¬¸ìì—´ í™•ì¸ (ì‹œê°„ëŒ€ ì•½ì–´ í¬í•¨)
        const str = dateObj.toLocaleString('en-US', { timeZone: 'America/Los_Angeles', timeZoneName: 'short' });
        const isPDT = str.includes('PDT');
        
        if (isPDT) {
            sdInfo.innerText = "í˜„ì¬ ì¸ë¨¸íƒ€ì„ ì ìš© ì¤‘ (PDT, UTC-7) â˜€ï¸";
            sdInfo.style.color = "#d63384";
        } else {
            sdInfo.innerText = "í˜„ì¬ í‘œì¤€ì‹œ ì ìš© ì¤‘ (PST, UTC-8) â„ï¸";
            sdInfo.style.color = "#666";
        }
    }

    function setNow() {
        const now = new Date();
        koreaInput.value = formatToLocalISO(now, 'Asia/Seoul');
        convertFromKorea(); // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ìƒŒë””ì—ê³  ì‹œê°„ ì—…ë°ì´íŠ¸
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ í˜„ì¬ ì‹œê°„ ì„¤ì •
    setNow();

</script>

</body>
</html>